specVersion: 0.0.4
description: Damx Trade Chainlink Prices Subgraph
repository: https://github.com/damx-io/damx-subgraph
schema:
  file: ./schema.graphql

dataSources:
  - kind: ethereum/contract
    name: FastPriceFeed
    network: bttc
    source:
      address: "0x0c23B059F1d29964Af60117980F7A7df142925F5"
      abi: FastPriceFeed
      startBlock: 14903696
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - ChainlinkPrice
        - CandlePrice
      abis:
        - name: FastPriceFeed
          file: ./abis/FastPriceFeed.json
      eventHandlers:
        - event: PriceData(address,uint256,uint256,uint256,uint256)
          handler: handlePriceData
      file: ./src/pricesMapping.ts

  - kind: ethereum/contract
    name: Vault2
    network: bttc
    source:
      address: "0x7ffb83011e32E4c92B8F7Be7085e6F3222Bd542c"
      abi: Vault
      startBlock: 14903489
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Volume
      abis:
        - name: Vault
          file: ./abis/VaultV2.json
      eventHandlers:
        - event: BuyUSDG(address,address,uint256,uint256,uint256)
          handler: handleBuyUSDG
        - event: SellUSDG(address,address,uint256,uint256,uint256)
          handler: handleSellUSDG
        - event: Swap(address,address,address,uint256,uint256,uint256,uint256)
          handler: handleSwap
        - event: IncreasePosition(bytes32,address,address,address,uint256,uint256,bool,uint256,uint256)
          handler: handleIncreasePosition
        - event: DecreasePosition(bytes32,address,address,address,uint256,uint256,bool,uint256,uint256)
          handler: handleDecreasePosition
        # - event: ClosePosition(bytes32,uint256,uint256,uint256,uint256,uint256,int256)
        #   handler: handleClosePosition
        - event: LiquidatePosition(bytes32,address,address,address,bool,uint256,uint256,uint256,int256,uint256)
          handler: handleLiquidatePosition
      file: ./src/vaultMapping.ts  
